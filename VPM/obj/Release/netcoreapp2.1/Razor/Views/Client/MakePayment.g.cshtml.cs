#pragma checksum "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "573cf257677b2e2bfa2ab636e3549298b9481b87"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Client_MakePayment), @"mvc.1.0.view", @"/Views/Client/MakePayment.cshtml")]
[assembly:global::Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorViewAttribute(@"/Views/Client/MakePayment.cshtml", typeof(AspNetCore.Views_Client_MakePayment))]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"573cf257677b2e2bfa2ab636e3549298b9481b87", @"/Views/Client/MakePayment.cshtml")]
    public class Views_Client_MakePayment : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#line 1 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
   Layout = "_Layout";

#line default
#line hidden
#line 2 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
   var user = (VPM.Models.mClient)ViewBag.user;

#line default
#line hidden
#line 3 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
   var prop = (VPM.Models.mProperty)ViewBag.property;

#line default
#line hidden
#line 4 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
   var ass = (List<VPM.Models.mAssignments>)ViewBag.ass;

#line default
#line hidden
            BeginContext(299, 2, true);
            WriteLiteral("\r\n");
            EndContext();
            BeginContext(318, 1530, true);
            WriteLiteral(@"<script type=""text/javascript"" src=""https://ravesandboxapi.flutterwave.com/flwv3-pug/getpaidx/api/flwpbf-inline.js""></script>
<style>
    form label {
        color: red !important;
    }
</style>
<div class=""container"">
    <div class=""row"">
        <div class=""col-md-12"">
            <div class=""card bshadow"">
                <div class=""card-header _active"">Make a payment</div>
                <div class=""card-body"">
                    <form id=""fid"" style=""color:red!important;"">

                        <div class=""row"">
                            <div class=""col-md-6"" style=""border-right:1px solid red;"">
                                <div class=""form-group"">
                                    <label style=""color:black!important;"">Select payment type</label>
                                    <select class=""form-control"" id=""PaymentType"" name=""PaymentType"">
                                        <option value=""artisanService"">Pay Artisan Service</option>
                        ");
            WriteLiteral(@"                <option value=""rentalPayment"">Pay Rent</option>
                                    </select>
                                </div>

                                <div class=""form-group"" id=""AssignmentID_"">
                                    <label style=""color:black!important;"">Select Assignment Your Paying For <span style=""color:red!important;"">*</span></label>
                                    <select class=""form-control"" id=""AssignmentID"" name=""AssignmentID"" required>
");
            EndContext();
#line 36 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                                         foreach (var a in ass)
                                        {

#line default
#line hidden
            BeginContext(1956, 51, true);
            WriteLiteral("                                            <option");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 2007, "\"", 2023, 1);
#line 38 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
WriteAttributeValue("", 2015, a._id, 2015, 8, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(2024, 1, true);
            WriteLiteral(">");
            EndContext();
            BeginContext(2027, 37, false);
#line 38 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                                                                 Write(globals.trimString(a.description, 70));

#line default
#line hidden
            EndContext();
            BeginContext(2065, 11, true);
            WriteLiteral("</option>\r\n");
            EndContext();
#line 39 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                                        }

#line default
#line hidden
            BeginContext(2119, 476, true);
            WriteLiteral(@"                                    </select>
                                    <small style=""color:#fff!important;"">You may only pay for an assignment which you have assigned to an artisan</small>
                                </div>

                                <div class=""form-group"" id=""PropertyID_"">
                                    <label style=""color:black!important;"">Property Your Paying Rent For <span style=""color:red!important;"">*</span></label>
");
            EndContext();
#line 46 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                                     if (prop != null)
                                    {

#line default
#line hidden
            BeginContext(2690, 131, true);
            WriteLiteral("                                        <input type=\"text\" required class=\"form-control\" readonly id=\"PropertyID\" name=\"PropertyID\"");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 2821, "\"", 2847, 1);
#line 48 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
WriteAttributeValue("", 2829, prop.propertyName, 2829, 18, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(2848, 5, true);
            WriteLiteral(" />\r\n");
            EndContext();
#line 49 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                                    }
                                    else
                                    {


#line default
#line hidden
            BeginContext(2975, 193, true);
            WriteLiteral("                                        <input type=\"text\" required class=\"form-control\" readonly id=\"PropertyID\" name=\"PropertyID\" placeholder=\"You do not have a property to pay rent for\" />\r\n");
            EndContext();
#line 54 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                                    }

#line default
#line hidden
            BeginContext(3207, 2375, true);
            WriteLiteral(@"                                </div>
                            </div>


                            <div class=""col-md-6"">
                                <div class=""form-group"">
                                    <label style=""color:black!important;"">Enter payment Reference <span style=""color:red;"">*</span></label>
                                    <input type=""text"" placeholder=""eg. payment for rent"" class=""form-control"" id=""paymentRef"" name=""paymentRef"" required />
                                </div>

                                <div class=""form-group"">
                                    <label style=""color:black!important;"">Enter payment amount <span style=""color:red;"">*</span></label>
                                    <input type=""number"" step=""any"" min=""0"" placeholder=""eg. 100000"" class=""form-control"" id=""paymentAmount"" name=""paymentAmount"" required />
                                    <br /><small style=""color:white!important;"">A transaction fee of 1.4% will be charged ");
            WriteLiteral(@"for local currency, 3.4% for foreign currency</small>
                                </div>
                            </div>
                        </div>



                    </form>



                </div>
                <div class=""card-footer"">
                    <div class=""form-group"">
                        <button type=""submit"" class=""btn btn-outline-success btn-block"">Pay Now</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br />
<br />

<script>

    $(""#AssignmentID_"").show(0);
    $(""#PropertyID_"").hide(0);


    var pt = """";
    $(""#PaymentType"").on(""change"", function () {
        pt = $(""#PaymentType"").val();
        console.log(pt);
        if (pt == ""rentalPayment"") {
            $(""#AssignmentID_"").hide(1000);
            $(""#PropertyID_"").show(1000);

        }
        else {

            $(""#AssignmentID_"").show(1000);
            $(""#PropertyID_"").hide(1000);
        }


");
            WriteLiteral(@"    });
</script>


<script>
   // const API_publicKey = ""FLWPUBK-27765de03cf4e262c850356fe395d115-X""; //live
    const API_publicKey = ""FLWPUBK-002565847dd0b6199bbc831eee3f48fc-X"";//test

    function payWithRave() {
        var x = getpaidSetup({
            PBFPubKey: API_publicKey,
            customer_email: """);
            EndContext();
            BeginContext(5583, 10, false);
#line 125 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                        Write(user.email);

#line default
#line hidden
            EndContext();
            BeginContext(5593, 63, true);
            WriteLiteral("\",\r\n            amount:_amount ,\r\n            customer_phone: \"");
            EndContext();
            BeginContext(5657, 11, false);
#line 127 "C:\Users\samaritan\Documents\VPM\VPM\Views\Client\MakePayment.cshtml"
                        Write(user.mobile);

#line default
#line hidden
            EndContext();
            BeginContext(5668, 882, true);
            WriteLiteral(@""",
            currency: ""NGN"",
            //redirect_url:""http://localhost:63029/Client/MakePayment"",
            txref: _txref,
            meta: [{
                metaname: ""flightID"",
                metavalue: ""AP1234""
            }],
            onclose: function () { },
            callback: function (response) {
                var txref = response.tx.txRef; // collect txRef returned and pass to a server page to complete status check.
                console.log(""This is the response returned after a charge"", response);
                var AssignmentID = $(""#AssignmentID"").val();
                var amount = $(""#paymentAmount"").val();
                var flwRef = response.tx.flwRef;
                if (
                    response.tx.chargeResponseCode == ""00"" ||
                    response.tx.chargeResponseCode == ""0""
                ) {
");
            EndContext();
            BeginContext(6599, 2053, true);
            WriteLiteral(@"                    $.ajax({
                        url: ""/Client/SavePaymentDetails"",
                        method: ""post"",
                        success: function () { },
                        error: function () { },
                        data: { txref: txref, pt: $(""#PaymentType"").val(), flwRef: flwRef, AssignmentID: AssignmentID,amount:amount}
                    });

                    $.confirm({
                        title: ""Information"",
                        content: ""The payment was successful, you will recieve a confirmation email"",
                        type: ""green"",
                        buttons: {
                            ""OK"": function () {
                                window.location=""/Client/PaymentHistory""
                             }
                        }
                    });
                } else {
                    $.alert({
                        title: ""Information"",
                        content: ""The payment was unsuccessful");
            WriteLiteral(@", please try again after a few minutes"",
                        type: ""red""
                    });
                }
                x.close(); // use this to close the modal immediately after payment.
            }
        });
    }
</script>

<script>
    var error = """";
    var _amount = 0;
    var _txref = """";
    $(""#fid"").validate();
    $(""#fid"").on(""submit"", function (e) {
        e.preventDefault();
        _amount = $(""#paymentAmount"").val();
        _txref = $(""#paymentRef"").val();
        var valid = $(""#fid"").valid();
        if (valid) {

            try {
                payWithRave();
            } catch (e) {
                $.alert({
                    title: ""Information"",
                    content: ""An error occurred "" + e,
                    type: ""red"",
                });
                console.log(e);
                error = e;
            }
        }
    });

    ///window.onbeforeunload = function () {
     //   return false;
    //}
</sc");
            WriteLiteral("ript>");
            EndContext();
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
